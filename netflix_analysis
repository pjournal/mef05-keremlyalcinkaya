---
title: "Netflix_analysis"
author: "kerem.yalcinkaya"
date: "03 11 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## A Tiny Netflix Analysis

This is small analysis of a Netflix dataset we download with the link <https://github.com/ygterl/EDA-Netflix-2020-in-R/raw/master/netflix_titles.csv>. Thanks for YiÄŸit Erol for sharing this dataset.  

I inspected the productions after the year 2000. We can see that there is a significant . After 2010, we can see a huge increasement with the number of series, and after 2019 there is a sharp decreasement with the numbers of movies. In 2019, TV show number is passed the movie numbers.

```{r}
library(readr)
netflix_titles <- read_csv("C:/Users/kerem.yalcinkaya/Downloads/netflix_titles.txt")
plot_n2<-netflix_titles%>%filter(release_year > 2000 & release_year!=2020) %>% group_by(across(c(release_year, type)))%>%summarize(prod_count=n(), .groups= 'drop')
plot_n2
```


## Year/Production Counts

Here is the line chart of this table:

```{r pressure, echo=FALSE}
ggplot(plot_n2,aes(x=release_year,y=prod_count,color=type)) + geom_line()
```

## Increasement of Production Counts By Genre After 2020

Here is the increasement values of genres. TV Action & Adventure has the highest increasement in genres.

```{r}
df_new<-netflix_titles%>%separate(cast, c("leadrole", "role2", "role3", "role4", "role5"), ", ")%>%
  separate(listed_in, c("genre1", "genre2", "genre3", "genre4", "genre5"), ", ")

plot_n3<-df_new%>%filter(release_year > 2000 & release_year!=2020) %>% arrange(genre1, release_year)%>%group_by(across(c(genre1,release_year)))%>%
  summarize(prod_count=n())%>%arrange(genre1,release_year)%>%mutate(prev_prod = lag(prod_count,1))%>%select(release_year,genre1,prod_count,prev_prod)%>%
  arrange(genre1,release_year)

inc1<-plot_n3%>%drop_na()%>%group_by(genre1)%>%arrange(genre1, release_year)%>%summarize(release_year,genre1, inc_prod = (prod_count/prev_prod)-1)

plot3<-inc1%>%group_by(genre1)%>%summarize(mean_inc=mean(inc_prod))
plot3
```

## Bar Chart of the Table Above

```{r}
ggplot(plot3,aes(x=genre1,y=mean_inc)) + geom_bar(stat="identity",aes(fill=genre1)) +  theme(axis.text.x=element_text(angle = 90, vjust = 0.5, hjust=1))

```


